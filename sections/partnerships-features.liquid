{% comment %}
  Partnerships Features Section
  Displays feature cards that toggle between image and text content
{% endcomment %}

<div class="partnerships-features-section" data-section-id="{{ section.id }}">
  <div class="partnerships-container">
    <div class="partnerships-grid">
      {% for block in section.blocks %}
        <div class="feature-card" data-card-id="{{ block.id }}">
          {%- comment -%} Badge - desaparece cuando está activa {%- endcomment -%}
          <div class="feature-badge" data-badge="{{ block.id }}">
            {{ block.settings.badge_text }}
          </div>

          {%- comment -%} Toggle Button - color #DCA1A1 {%- endcomment -%}
          <button 
            class="feature-toggle-btn" 
            aria-label="Toggle feature details"
            data-toggle-btn="{{ block.id }}"
          >
            <svg class="toggle-icon toggle-icon-plus" width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M10 4V16M4 10H16" stroke="white" stroke-width="2" stroke-linecap="round"/>
            </svg>
            <svg class="toggle-icon toggle-icon-close" width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M6 6L14 14M6 14L14 6" stroke="white" stroke-width="2" stroke-linecap="round"/>
            </svg>
          </button>

          {%- comment -%} Image Content (default view) {%- endcomment -%}
          <div class="feature-image-content" data-image-content="{{ block.id }}">
            {% if block.settings.image != blank %}
              <img 
                src="{{ block.settings.image | image_url: width: 800 }}"
                alt="{{ block.settings.image.alt | default: block.settings.title }}"
                loading="lazy"
                class="feature-image"
              >
            {% else %}
              <div class="feature-image-placeholder">
                <svg width="100" height="100" viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <rect width="100" height="100" fill="#E5E7EB"/>
                  <path d="M50 30V70M30 50H70" stroke="#9CA3AF" stroke-width="4" stroke-linecap="round"/>
                </svg>
              </div>
            {% endif %}
            
            {% if block.settings.image_caption != blank %}
              <div class="feature-image-caption">
                {{ block.settings.image_caption }}
              </div>
            {% endif %}
          </div>

          {%- comment -%} Text Content (expanded view) - solo párrafo y botón {%- endcomment -%}
          <div class="feature-text-content" data-text-content="{{ block.id }}">
            <div class="feature-text-inner">
              {% if block.settings.description != blank %}
                <p class="feature-description">{{ block.settings.description }}</p>
              {% endif %}

              {% if block.settings.button_text != blank %}
                <a 
                  href="{{ block.settings.button_link | default: '#' }}" 
                  class="feature-cta-button"
                >
                  {{ block.settings.button_text }}
                </a>
              {% endif %}
            </div>
          </div>
        </div>
      {% endfor %}
    </div>
  </div>
</div>

<style>
  .partnerships-features-section {
    width: 100%;
    padding: 60px 20px;
    background-color: {{ section.settings.section_bg_color }};
  }

  .partnerships-container {
    margin: 0 auto;
  }

  .partnerships-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 24px;
    padding: 24px 96px;
  }

  .feature-card {
    position: relative;
    border-radius: 16px;
    overflow: hidden;
    background-color: #ffffff;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    aspect-ratio: 3 / 4;
  }

  .feature-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 12px 24px rgba(0, 0, 0, 0.15);
  }

  /* Badge con color #DCA1A1 y desaparece cuando está activa */
  .feature-badge {
    position: absolute;
    top: 16px;
    left: 16px;
    padding: 6px 16px;
    border-radius: 20px;
    font-size: 0.875rem;
    font-weight: 600;
    color: white;
    background-color: #DCA1A1;
    z-index: 10;
    transition: opacity 0.3s ease;
  }

  .feature-card.active .feature-badge {
    opacity: 0;
  }

  /* Botón de toggle con color #DCA1A1 */
  .feature-toggle-btn {
    position: absolute;
    top: 16px;
    right: 16px;
    width: 40px;
    height: 40px;
    border-radius: 50%;
    border: none;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 10;
    transition: transform 0.2s ease, background-color 0.2s ease;
    background-color: #DCA1A1;
  }

  .feature-toggle-btn:hover {
    transform: scale(1.1);
    background-color: #c98f8f;
  }

  .toggle-icon {
    position: absolute;
    transition: opacity 0.3s ease, transform 0.3s ease;
  }

  .toggle-icon-plus {
    opacity: 1;
    transform: rotate(0deg);
  }

  .toggle-icon-close {
    opacity: 0;
    transform: rotate(90deg);
  }

  .feature-card.active .toggle-icon-plus {
    opacity: 0;
    transform: rotate(90deg);
  }

  .feature-card.active .toggle-icon-close {
    opacity: 1;
    transform: rotate(0deg);
  }

  .feature-image-content {
    position: absolute;
    inset: 0;
    opacity: 1;
    transition: opacity 0.4s ease;
    pointer-events: auto;
  }

  .feature-card.active .feature-image-content {
    opacity: 0;
    pointer-events: none;
  }

  .feature-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .feature-image-placeholder {
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    background-color: #F3F4F6;
  }

  .feature-image-caption {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    padding: 16px;
    background: linear-gradient(to top, rgba(0, 0, 0, 0.7), transparent);
    color: white;
    font-size: 1rem;
    font-weight: 600;
  }

  /* Fondo blanco con blur del color #DCA1A1 para el contenido de texto */
  .feature-text-content {
    position: absolute;
    inset: 0;
    opacity: 0;
    transition: opacity 0.4s ease;
    pointer-events: none;
    /* Fondo blanco con overlay semi-transparente del color #DCA1A1 */
    background-color: #ffffff;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 32px;
  }

  /* Overlay con color #DCA1A1 semi-transparente sobre fondo blanco */
  .feature-text-content::before {
    content: '';
    position: absolute;
    inset: 0;
    background-color: rgba(220, 161, 161, 0.15);
    pointer-events: none;
  }

  .feature-card.active .feature-text-content {
    opacity: 1;
    pointer-events: auto;
  }

  .feature-text-inner {
    text-align: center;
    max-width: 100%;
    position: relative;
    z-index: 1;
  }

  /* Texto del párrafo a 18px */
  .feature-description {
    font-size: 18px;
    line-height: 1.6;
    color: #374151;
    margin-bottom: 24px;
  }

  /* Botón con color #DCA1A1 */
  .feature-cta-button {
    display: inline-block;
    padding: 12px 32px;
    border-radius: 24px;
    font-size: 0.875rem;
    font-weight: 600;
    text-decoration: none;
    background-color: #DCA1A1;
    color: white;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    transition: transform 0.2s ease, background-color 0.2s ease;
  }

  .feature-cta-button:hover {
    transform: translateY(-2px);
    background-color: #c98f8f;
  }

  /* Tablet */
  @media (max-width: 1024px) {
    .partnerships-grid {
      grid-template-columns: repeat(2, 1fr);
      gap: 20px;
    }
  }

  /* Mobile */
  @media (max-width: 640px) {
    .partnerships-features-section {
      padding: 40px 16px;
    }

    .partnerships-grid {
      grid-template-columns: 1fr;
      gap: 16px;
    }

    .feature-card {
      aspect-ratio: 4 / 5;
    }

    .feature-text-content {
      padding: 24px;
    }

    .feature-description {
      font-size: 16px;
    }
  }
</style>

<script>
  (function() {
    const sectionId = '{{ section.id }}';
    const section = document.querySelector(`[data-section-id="${sectionId}"]`);
    
    if (!section) return;

    const cards = section.querySelectorAll('.feature-card');
    
    cards.forEach(card => {
      const toggleBtn = card.querySelector('[data-toggle-btn]');
      
      if (toggleBtn) {
        toggleBtn.addEventListener('click', function(e) {
          e.preventDefault();
          e.stopPropagation();
          
          // Toggle active state
          card.classList.toggle('active');
        });
      }
    });
  })();
</script>

{% schema %}
{
  "name": "Partnerships Features",
  "tag": "section",
  "class": "section-partnerships-features",
  "settings": [
    {
      "type": "color",
      "id": "section_bg_color",
      "label": "Section Background Color",
      "default": "#FFFFFF"
    }
  ],
  "blocks": [
    {
      "type": "feature",
      "name": "Feature Card",
      "settings": [
        {
          "type": "text",
          "id": "badge_text",
          "label": "Badge Text",
          "default": "Creator"
        },
        {
          "type": "image_picker",
          "id": "image",
          "label": "Feature Image"
        },
        {
          "type": "text",
          "id": "image_caption",
          "label": "Image Caption",
          "default": "Create Inspiring Content"
        },
        {
          "type": "textarea",
          "id": "description",
          "label": "Description",
          "default": "Partner with SWAN to showcase your expertise through tutorials, product demos, and personalized beauty content. Monetize your influence and connect directly with audiences who match your aesthetic and skincare profiles."
        },
        {
          "type": "text",
          "id": "button_text",
          "label": "Button Text",
          "default": "JOIN AS A CREATOR"
        },
        {
          "type": "url",
          "id": "button_link",
          "label": "Button Link"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Partnerships Features",
      "blocks": [
        {
          "type": "feature",
          "settings": {
            "badge_text": "Creator",
            "image_caption": "Create Inspiring Content",
            "description": "Partner with SWAN to showcase your expertise through tutorials, product demos, and personalized beauty content. Monetize your influence and connect directly with audiences who match your aesthetic and skincare profiles.",
            "button_text": "JOIN AS A CREATOR"
          }
        },
        {
          "type": "feature",
          "settings": {
            "badge_text": "Brand Partner",
            "image_caption": "Reach Consumers in a Smarter Way",
            "description": "SWAN gives beauty brands a powerful new channel for discovery and conversion. Showcase products within the Mirror experience and app, reach highly targeted consumers, and turn personalized recommendations into real-time sales.",
            "button_text": "BECOME A BRAND PARTNER"
          }
        },
        {
          "type": "feature",
          "settings": {
            "badge_text": "Business Solutions",
            "image_caption": "Bring Intelligent Beauty In-Store",
            "description": "From salons and spas to aesthetics studios, the SWAN Mirror transforms your client experience with interactive consultations, AI analysis, and product integration. Enhance service offerings and retail opportunities with cutting-edge beauty tech.",
            "button_text": "EXPLORE BUSINESS SOLUTIONS"
          }
        }
      ]
    }
  ]
}
{% endschema %}
